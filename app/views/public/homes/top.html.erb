<% if customer_signed_in? %>
<div class="container">
  <div class="row">
    <div class="col-lg-8 col-md-6 col-12">
      <div class="map-wrap">
      <h2 class="text-center mt-5">休憩地図</h2>
      <input id="address" type="textbox" value="" class="">
      <input type="button" value="検索" onclick="codeAddress()" class="btn btn-secondary">
      <div id='map' class="map mt-3"></div>
      <style>
      
      </style>
      <script>
      let map
      const display = document.getElementById('display')

      function initMap(){
        geocoder = new google.maps.Geocoder()

        map = new google.maps.Map(document.getElementById('map'), {
          center: {lat: 35.681298, lng:139.766247},
          zoom: 12,
        });

        marker = new google.maps.Marker({
          position:  {lat: 40.7828, lng:-73.9653},
          map: map
        });

      }
      let geocoder

      function codeAddress(){
        let inputAddress = document.getElementById('address').value;

        geocoder.geocode( { 'address': inputAddress}, function(results, status) {
          if (status == 'OK') {
            map.setCenter(results[0].geometry.location);
            var marker = new google.maps.Marker({
                map: map,
                position: results[0].geometry.location
            });
            display.textContent = "検索結果：" + results[ 0 ].geometry.location
          } else {
            alert('該当する結果がありませんでした：' + status);
          }
        });
      }
      </script>
      <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCWCa5GDZBE09G610gyGsIi4akQup_x7qQ&callback=initMap" async defer></script>
    </div>
    </div>
    <div class="col-lg-3 mt-4">

      <% if @rest.errors.any? %>
        <%= @rest.errors.count %>件のエラーが発生しました
        <ul>
          <% @rest.errors.full_messages.each do |message| %>
            <li><%= message %></li>
          <% end %>
        </ul>
      <% end %>
      <%= render "public/rests/form", rest: @rest %>
    </div>
  </div>
</div>
<% else %>
<div class="container">
  <div class="row d-flex align-items-center">
    <div class='mx-auto col-11 col-sm-10 col-lg-8 col-xl-6 text-center'>
      <h1>ぐ～たライフへようこそ！</h1>
      <p>ここは全国の休憩スポットを探すことができるサイトです。</p>
      <p>ユーザー登録をしなくても投稿を見ることが可能ですが</p>
      <p>ユーザー登録をすることでお気に入り機能の利用や投稿が可能になります。</p>
      <div class="btn-wrapper col-10 mx-auto">
        <div class="row">
          <%= link_to 'ゲストログイン',customers_guest_sign_in_path, method: :post, class: "btn btn-secondary btn-sm btn-block mb-3 gest_sign_in" %>
        </div>
        <div class="row">
          <%= link_to 'ログイン',new_customer_session_path, class: "btn btn-info btn-sm btn-block mb-3 sign_in" %>
        </div>
        <div class="row">
          <%= link_to '新規登録',new_customer_registration_path, class: "btn btn-success btn-sm btn-block sign_up" %>
        </div>
      </div>
    </div>
  </div>
</div>
<% end %>